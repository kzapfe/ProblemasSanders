\documentclass[a4paper,10pt]{article}

\usepackage[utf8]{inputenc}
\usepackage{amsmath, amsfonts}
\usepackage{graphicx}
\usepackage{natbib}
\usepackage{caption}
\usepackage{subcaption}


\bibliographystyle{alpha}

%opening
\title{Exact kinetics of two hard discs in a rectangular box}
\author{Rosa Rodríguez \& David P.~Sanders \& W. P. K. Zapfe}
\affiliation{Departamento de Física, Facultad de Ciencias, Universidad Nacional Autónoma de México, Ciudad Universitaria, Del.~Coyoacán, México D.F. 04510, Mexico}

\usepackage{mathptmx}

\newcommand{\defeq}{:=}
\newcommand{\mean}[1]{\left \langle #1 \right \rangle}
\newcommand{\rd}{\, \mathrm{d}}
\newcommand{\RR}{\mathbb{R}}
\newcommand{\vv}{\mathbf{v}}
\newcommand{\indicator}[1]{\mathbf{1}_{ \{   #1 \} } } 

\setlength{\parskip}{10pt}
\setlength{\parindent}{0pt}

\begin{document}

\maketitle
\begin{abstract}
  We obtain exact results for the kinetics of the inertial motion of 
two hard discs in a rectangular two-dimensional box.
  In particular,  we calculate exactly the mean hopping time between exchanges
 of the horizontal positions of the discs, 
as well as mean collision rates between the two discs and 
 between the discs and the box. We compare this with numerical experiments.
\end{abstract}

\section{Introduction}

Hard sphere billiards are one of the most recurred models in
statistical physics and non linear dynamics.  Some of the simplest models
 provide us with a deep mathematical understanding
about the qualitative aspects of their evolution, such as 
the propiertes under the moniquer \emph{Hard Chaos} (
hyperbolicity, ergodicity and mixing qualities). One such system is the
gas of disks in a rectangular box, a two dimensional realization of a
hard sphere gas. It is known that such a system is chaotic in the
strong sense \cite{Sinai70}. 
For the statistical physicist, \emph{mean} and \emph{first} encounter
times are of uttermost importance, as many propierties,
such as mixing rates and the physical origin of a positive
Liapunov exponent, depend on it. 

The minimal realization of this
system consists in two disks of same mass and radius inside a 
rectangular box. This system displays hard chaos and 
is ameneable to treatment using
results from ergodic theory. 


\section{Model}

We consider two discs of radius $r$ (and diameter $d=2r$) 
in a box of width $w$ and height $h$ (figure
\ref{billar01}). 
The discs move inertially in the absence of forces, 
following straight line trajectories,
and undergo elastic collisions with each 
other and with the walls of the box.

\begin{figure}[h]
  \centering
  \includegraphics[width=0.56\textwidth]{DiscosenCajaCuadrada01.pdf}
  \caption{The Billiard}\label{billar01}
\end{figure}


We denote the position of the centre of the $i$th disc by 
$(x_{i}, y_{i})$ for $i=1,2$. Since the discs are hard, 
the disc centres are restricted to the region 
$(x_i, y_i) \in [-a,a] \times [-b, b]$, where 
$a \defeq a(d) \defeq \frac{w}{2} - r = \frac{w-d}{2}$ and
 $b \defeq b(d) \defeq \frac{h}{2} - r = \frac{h-d}{2}$.


The exclusion condition is $(x_1-x_2)^2 + (y_1-y_2)^2 \ge (2r)^2 = d^2$.
It is thus useful to work in terms of the new coordinates
\begin{equation}\label{cambiocoor01}
 x \defeq \frac{x_1 - x_2}{\sqrt{2}}; 
\quad X \defeq \frac{x_1 + x_2}{\sqrt{2}}; 
\quad y \defeq \frac{y_1 - y_2}{\sqrt{2}}; 
\quad Y \defeq \frac{y_1 + y_2}{\sqrt{2}}.
\end{equation}


In these coordinates the conditions are rewritten as
$x \in [-a \sqrt{2}, +a \sqrt{2}]$ with 
$X \in [-a \sqrt{2} + |x|, a \sqrt{2} - |x|]$, respectively 
 $y \in [-b \sqrt{2}, b \sqrt{2}]$ and $Y \in [-b \sqrt{2} + |y|, +b \sqrt{2} - |y|]$,  
with the constraint $x^2 + y^2 \ge \frac{d^2}{2}$.

The exclusions define a hypercube with a hypercylinder inside, placed diagonally 
from one hyperarista to its opposite. 
The dynamics in such a space follow
the usual billiard rules: free flight until
encounter with a wall, then ellastic reflection.
The outer borders are flat, so the
hyperbolicity is due only to the inner dispersing
boundary \cite{Sim99}, which represents the collition of
two disks in the original space.



\subsection{Assumptions for the Collision Rates}

There are two aparently similar but fustratingly different events.
If we want to calculate a \emph{Recurrence time}, 
we should depart from the subset of all outgoing trajectories from the surface of the
hyper-cylinder. If we want to calculate the \emph{first} encounter time, then
this supposition is not necessary, but actually, this complicates
the model, as there are no general results or 
techniques to describe this collition. 

This kind of systems are equivalent to Bernoulli Flows \cite{Sinai70}.
For such systems is expected an exponential decay of 
distributions \cite{AbadiGalves} with potentially
long algebraic tails \cite{ZasTip} This includes recurrence times and
first encounter times. 
 

\section{Mean time between events}

A system of $N$ hard spheres confined by hard walls in a $d$ dimensional
space may be treated as a billiard system 
in which a single point  particle undergoes free motion between reflecting obstacles 
in a $ d N $-dimensional configuration space \cite{Sinai70, MarkChern} . 

If the resulting billiard is ergodic and hyperbolic, 
there is a result for the mean free time, i.e.\ the mean time between 
collisions of the particle with the walls \cite{MarkChern}. 
This can be thought of as a mean return time to the $(d-1)$-dimensional 
(i.e. co-dimension-$1$) cross-section given by the wall boundaries.
The formula for this is
\begin{equation}\label{meanfreetime}
 \mean{\tau} = \frac{|Q|}{|A|} \frac{|S^{d-1}|}{|B^{d-1}|}.
\end{equation}
Here $|Q|$ denotes the $d$-dimensional volume of the available space in the billiard and 
$|A|$ the $(d-1)$-dimensional area of the cross-section.
 $|S^{d-1}|$ is the $(d-1)$-dimensional area of the unit sphere in $\RR^d$ given by
\begin{equation}
  |S^{d-1}| = \frac{2 \pi^{d/2}}{\Gamma(d/2)},
\end{equation}
where $\Gamma(\cdot)$ is the gamma function. 
$|B^{d-1}|$ is the volume of the unit ball 
in $\RR^{d-1}$, given by $|B^{d-1}| = |S^{d-2}| / (d-1)$.
In the formula \ref{meanfreetime}  the particle has 
its velocity scaled to unity.

Machta and Zwanzig \cite{MachtaZwan} used a similar method to derive an escape 
time across a non-existent boundary by treating it as a recurrence time.
Since it is an escape time, they used velocities whose components point only 
perpendicularly to the ``exit wall''.

In our case, we are interested in the mean return time to a co-dimension-$1$ cross section, 
which is defined by the exact moment
in which the disk interchange their horizontal position. This is simply
\begin{equation} \label{condchoque}
x_1 = x_2.
\end{equation}
This surface is accessible from \emph{both} sides, 
so that there is an extra factor of two in the part of the velocities. Thus 
we rewrite the mean time taking this into account: 
\begin{equation}
 \mean{\tau} = \frac{|Q| \, |S^{d-1}|} {2 \, |A| \, |B^{d-1}|}.	
\end{equation}
Given that each disk has different momentum, but
they can interchange it without affecting the
total energy, we must take into account the mass $m$ of each disk and the total kinetic energy $E$.
If both discs have the same mass then $\sum_i \vv_i^2 = 2E / m$.
The above result, as derived by Chernov, was for the case $\sum_i \vv_i^2 = 1$, or $m=1$ and $E=\frac{1}{2}$.  
For more general values of $E$ and $m$, we are simply working on a different energy surface in phase space. 
The particle trajectories are identical but their motion is a factor
$\sqrt{2E/m}$ faster, so that all times are reduced by this factor, giving our version for
the mean time between events.
\begin{equation}
  \mean{\tau} = \frac{1}{\sqrt{2E / m}} 
\frac{|Q| \, |S^3|} {2 \, |A| \, |B^3|}.	
\end{equation}



\section{Calculation of Volumes and Areas}

We proceed to calculate the Area and Volume quantities.  The configuration
space is an hypercube with an hyper-cylinder substracted in a diagonal position.
The uncomfortable part is to deal with the tips of the cylinder, which
present the  shape of a wedge with a circular base and two 
orthogonal ``heights''. 
The calculation can be carried out indirectly, using indicator functions.


\subsection{Volume of available space}


We shall present the total four-dimensional volume as a product integral
of all available positions. To better grasp the idea, a convenient
diagram is shown in the next figure, \ref{diagintegra01}.

\begin{figure}[h]
  \centering
  \includegraphics[width=0.8\textwidth]{diagramintegra01.pdf}
  \caption{The space to integrate is the product of the subspaces
    belonging to horizontal and vertical coordinates. The colour
    shaded area represents the ``exclusion'' set, where the condition 
    $ (x_1-x_2)^2 + (y_1-y_2)^2 \ge d^2 $ is not fulfilled. 
    Their width is dependent on the particular point of evaluation
    on the \emph{other} subspace. The diagonal coordinates
    make the expression to evaluate simpler. Due to 
    symmetry, we only evaluate the area in stripes and
    multiply by 16.}\label{diagintegra01}
\end{figure}

\begin{equation}
 V = \int_{x_1 = -a}^a \rd x_1 \int_{x_2 = -a}^a \rd x_2 
\int_{y_1 = -b}^b \rd y_1 \int_{y_2 = -b}^b \rd y_2 \, \indicator{ (x_1-x_2)^2 + (y_1-y_2)^2 \ge d^2 },
\end{equation}
where $\indicator{Z}$ indicates the indicator function of the set $Z$, given by $\mathbf{1}_Z (x) = 1$ if $x \in Z$, and $=0$ if $x \notin Z$, which restricts the integral to the desired region $Z$.

We represent the excluded cylinder in the coordinates defined in 
the set of equation \ref{cambiocoor01}. 

\begin{equation}
 V = \int_{x=-a \sqrt{2}}^{a \sqrt{2}} \rd x 
\int_{X=-a \sqrt{2} + |x| }^{a \sqrt{2} - |x|}  \rd X
 \int_{y=-b \sqrt{2}}^{b \sqrt{2}} \rd y
\int_{Y=-b \sqrt{2} + |y| }^{b \sqrt{2}-|y|}  \rd Y
\, \indicator{ x^2 + y^2 \ge \frac{d^2}{2}  }.
\end{equation}
In these coordinates, $X$ and $Y$ do not appear in the integrand, so that these integrals may be done trivially, thus reducing to the following two-dimensional integral:
\begin{align}
 V &= \int_{x=-a \sqrt{2}}^{a \sqrt{2}} \rd x  \int_{y=-b \sqrt{2}}^{b \sqrt{2}} \rd y
\, 2 \left( a \sqrt{2} - |x| \right) \, 2 \left( b \sqrt{2} - |y| \right) \,  \indicator{ x^2 + y^2 \ge \frac{d^2}{2} } \\
&= 16 \int_{x=0}^{a \sqrt{2}} \rd x  \int_{y=0}^{b \sqrt{2}} \rd y
\, \left( a \sqrt{2} - x \right) \, \left( b \sqrt{2} - y \right) \,  \indicator{ x^2 + y^2 \ge \frac{d^2}{2} },
\end{align}
using the symmetry.

Thus $V = 16(I_1 + I_2)$, where $I_1$ and $I_2$ are the resulting integrals over the regions where the available region for $y$ is affected by, and is not affected by, respectively, the restriction to lie outside the disc.
We have
\begin{align}
 I_1 &= \int_{x=0}^{d / \sqrt{2}} \left[ \int_{y = \sqrt{\frac{1}{2} {d^2} - x^2}}^{b \sqrt{2}} \left( b \sqrt{2} - y \right) \rd y \right]  \left( a \sqrt{2} - x \right) \rd x \\
&= 	
a b^{2} d + \textstyle \frac{1}{6} (a+b) d^{3} - \frac{1}{32}  d^{4} - \frac{1}{4} {\left(\pi a b + b^{2}\right)} d^{2},
\end{align}
and
\begin{align}
 I_2 &= \int_{x=d / \sqrt{2}}^{a \sqrt{2}} \left[ \int_{y = 0}^{b \sqrt{2}} \left( b \sqrt{2} - y \right) \rd y \right]  \left( a \sqrt{2} - x \right) \rd x \\
&=	
{\left( a^{2} - a d + \textstyle \frac{1}{4}  d^{2}\right)} b^{2}.
\end{align}
Thus 
\begin{equation}\label{volumeabd}
 V %= 16(I_1 + I_2) =     	
= 16 a^{2} b^{2}  - 4 \pi a b d^{2} + \textstyle \frac{8}{3} (a+b) d^{3}  - \frac{1}{2} d^{4},
\end{equation}
as was previously obtained by Munakata and Hu \cite{Munakata02}.

Note the volume available to place two discs inside the hard box but \emph{without} the 
 hard-disc exclusion constraint is simply given by the first term, $16 a^2 b^2$; thus, the remaining terms represent the excluded volume due to this constraint.

We have checked this result with simple Monte Carlo simulations, by generating random positions for the sphere centres in $[-a,a] \times [-b,b]$ uniformly and 
counting the proportion of such initial conditions for which the two spheres do not overlap.


%  $x$, and does not depend on $x$, respectively

\subsection{Volume of cross-section $\{x_1 = x_2\}$}
The calculation of the $3$-dimensional volume of the cross-section $\{x_1 = x_2\}$, which becomes 
$\{ x=0 \}$ in the new coordinates, proceeds in a similar way:

\begin{align}
 A &= \int_{X=-a \sqrt{2} }^{a \sqrt{2}}  \rd X
 \int_{y=-b \sqrt{2}}^{b \sqrt{2}} \rd y
\int_{Y=-b \sqrt{2} + |y| }^{b \sqrt{2}-|y|}  \rd Y
\, \indicator{y^2 \ge \frac{d^2}{2} } \\
&= 8 a \sqrt{2} \int_{y=0}^{b \sqrt{2}} \left( b \sqrt{2} - y \right)  \indicator{y \ge \frac{d}{\sqrt{2}}}  \rd y \\
&= 8 a \sqrt{2} \int_{y= \frac{d}{\sqrt{2}}}^{b \sqrt{2}}  \left( b \sqrt{2} - y \right)  \rd y \\
&= 2 \sqrt{2} a ( 2b - d )^2.
% b^{2} -  b d + \frac{d^{2}}{4} \right) .
\end{align}

We have checked this result with simple Monte Carlo simulations, by counting the proportion of successful placements of hard discs for which the distance $|x_1 - x_2|$ is within a small tolerance of $0$.


\subsubsection{I do not know if all this is worth it \ldots}
For comparison, we shall use also other area to compare
some properties of the decay of time distributions. The most natural and simple
time would be the mean time between any two collisions. This corresponds
to the adequate measure of the border of the four dimensional
billiard in which the dynamics takes place. There is a nice trick
to obtain this Area once that we know the Volume formula. The Area
can be thought of an infinitesimal volume element, so we have to put
all the volume from the measures as function of a single parameter
and derive with respect to it. 
There are some care that we must take into account:
Every ``face'' has to be taken into account, so each augmentation of 
a parameter which ends in two faces has to be taken twice.
Other difficult arises because our
billiard is not a convex set. When dealing with figures
which are not topologically spheres, this trick requires
a grain of salt. The parameter has to take different
signs for the \emph{negative} volume elements. A geometrical
intuitive grasp can be obtained by applying the trick to an annulus:
To get the border measure, we increase the outer circle and
decrease the inner one. The infinitesimal difference between the two
is the perimeter. 


 We start with formula \ref{volumeabd}
and substitute the auxiliary symbols $a,$ for their expression in
terms of $w,h$.
\begin{equation}\label{volumehwd}
 V= (w-d)^2(h-d)^2-\pi(w-d)(h-d)d^2+\frac{4}{3}(h+w-2d)d^3-\frac{1}{2}d^4
\end{equation}
The first term is simply the rectangular hyperprism, the variation in question
would be:

We make a slight variation on all the terms which  define the geometry,
making the substitutions
\begin{align}
w & \rightarrow w+\epsilon \\
h & \rightarrow h+\epsilon \\
d & \rightarrow d+\epsilon ,
\end{align}
resulting in
\begin{equation}\label{volumeepsilon}
 V(\epsilon) = (w-d)^2(h-d)^2-\pi(w-d)(h-d)(d+\epsilon)^2+
\frac{4}{3}(h+w-2d)(d+\epsilon)^3-\frac{1}{2}(d+\epsilon)^4.
\end{equation}

Then, taking the derivative at $\epsilon=0$, we obtain

\begin{equation}\label{Areaepsilon}
 \frac{dV}{d\epsilon} \vert_{\epsilon=0}
= d^2(w+h)(4+2\pi)-d^3
\end{equation}


\subsection{Mean hopping time}

In order to simplify things, we will use $E=1/2$ and $m_i=1$.
The system of two hard discs is equivalent to a billiard in $d=4$ dimensions, so that

\begin{equation}
 |S^{d-1}| = |S^3| = 2 \pi^2; \qquad |B^{d-1}| = 4 \pi / 3.
\end{equation}

Inserting these results into the formula for the mean hopping time gives
\begin{equation}
 \mean{\tau} = 	
\frac{3 \pi}{4}
\frac
{16 a^{2} b^{2}  - 4 \pi a b d^{2} + \textstyle \frac{8}{3} (a+b) d^{3}  - \frac{1}{2} d^{4}}
{ 2 \sqrt{2} a ( 2b - d )^2}.
\end{equation}

Substituting the expressions for $a$ and $b$ in terms of $w$, $h$ and $d$ gives
the main result of this paper, the exact expression for the mean hopping time:
\begin{equation}\label{hoptimegeneral}
 \mean{\tau} = \frac{3 \pi}{4 \sqrt{2}}
\frac{(w-d)^2(h-d)^2-\pi(w-d)(h-d)d^2+\frac{4}{3}(h+w-2d)d^3-\frac{1}{2}d^4}
{(w-d)(h-2d)^2}
\end{equation}

As one can directly perceive from the denominator in the last expression, the
time blows up quadratically as $d\rightarrow h/2$, which agrees
with heuristic arguments. 

We will use for comparison with numeric square boundaries, 
so that $h=w$. This simplifies a bit more the above 
formula:

\begin{equation}\label{hoptimesquare}
 \mean{\tau} =\frac{3\pi}{8\sqrt{2}} 
\frac{(h-d)^4-\pi(h-d)^2d^2+\frac{8}{3}(h-d)d^3-\frac{1}{2}d^4}
{(h-d)(h-2d)^2}
\end{equation}



\section{Lo que falta}

\emph{Comparison with numeric: is perfect!}

Oh yeah? Which Numerics???
Well, more or less. There seems to be some issues about the convergence of the
data, but is to be expected. First, I show you my semi manual results of
the mean hopping time. I will put here some examples of the
distributions, as they show why the convergence occurs better for some
sizes than for others.

The next figure, \ref{MeanHopp01} shows the theoretical curve 
expressed in the formula \ref{hoptimesquare} and some points
that Karel obtained from numerical experiments. The most interesting
parts of the curve where sampled more, while the ``boring'' part
of the curve has just a pair of points. This flatter section of
the behaviour shows much better convergence, and I think a
good heuristic argument can be made for this.

\begin{figure}[h]
  \centering
  \includegraphics[width=0.56\textwidth]{Mean_Hopping_Time_manual.png}
  \caption{The mean hopping time as function of the diameter, Energy, mass, and geometry fixed.
The red line is theoretical, the black dots are the numerical experiments, and the error bars
represent the standard deviation.}\label{MeanHopp01}
\end{figure}

From the figure we can see that the explosive regime falls a bit short of
the theoretical estimate, while  the flat regime has a slightly longer
time than expected. This has to do with the mixing and averaging scales
of the numerical experiments, and is a consequence of some
qualitative differences between small, medium and big disks. The numerics where done
by limiting the number of collisions, of all types, taking into account
that the average time between collisions is a good scale of time
for billiard systems. This sets a lower limit for collations between
disks in the smaller regime, as this became effectively very
improbable in the short term. This affects the ``short term ergodicity'' and
mixing rates of the system. For relative low sampling limits, the
smaller disks behave effectively as if each was alone in the box, thus
producing results which have some qualities of integrable systems. 

\begin{figure}[h]
        \centering
        \begin{subfigure}[b]{0.45\textwidth}
                \centering
                \includegraphics[width=\textwidth]{HoppingTimesradio01.pdf}
                \caption{$d=0.1$}
                \label{smallradious}
        \end{subfigure}%
        ~ %add desired spacing between images, e. g. ~, \quad, \qquad etc.
          %(or a blank line to force the subfigure onto a new line)
        \begin{subfigure}[b]{0.45\textwidth}
                \centering
                \includegraphics[width=\textwidth]{HoppingTimesRadius249.pdf}
                \caption{$d=0.249$}
                \label{bigradious}
        \end{subfigure}       
        \caption{Histograms for the mean hopping time
in two extreme cases. Left is a very small diameter, while right is an almost
closed pass. While it is not customary to compare logarithmic and non
logarithmic scales, here I take that liberty for the funny features to be
more exaggeratedly shown.}\label{histohopps}
\end{figure}

The figure \ref{bigradious} shows clearly an exponential decay in the
distribution, something to be expected for a chaotic system \cite{OttLibro} , while the
figure in \ref{smallradious} is something different. 


\subsection{ To do : }
To do: comparison of our mean hopping time with the mean *first* time to hop, which is what is studied in other papers.
Hopefully (and presumably) they are the same asymptotically when $\epsilon \to 0$? 

For square box, can escape in either direction, so hopping time (including in other direction) should be half? Could be. The events are ``almost independent'', so each one
can occur first with probability one half. If the disks are very small, then
they are truly independent events, but if they are big, one event taking
place hinders the other, so probably we should not think that is 
one half. A careful inspection for the $\|A\|$ element in formula \ref{hoptimegeneral}
should be the answer to that.


 3D?  Must be long channel. Spheres may be confined in 1 direction  and only able to exchange in other direction, or be able to exchange in two directions.
This probably affects asymptotes.}

Escape time through a hole in the wall?? (Probably leave for future.)
Mean time between disc collisions, collisions with walls. Should be easy with the formula

Distributions of all these times (numerical with histogram).



\section{About the Hyperbolicity}

The system is clearly strongly chaotic, as follows from
the general arguments given in the references \cite{Sim99, MarkChern}.
The hyperbolic property shall be verified with the technique described
in \cite{Dellago96}. The tangent map given there can be considerably
simplified for the case of two disks and flat rigid walls.

The difficulty on displaying the effect of this tangent map over
an 8 dimensional manifold
can be overpass with a little ingenuity \cite{Tufte}. However,
the reader must make more effort to understand high density data
plots. A brief explanation of the figure \ref{TangentMap} would
be in order here. 

We would colour the position of the disks by the number of
the last collision, that is, the number of iterations of
the Birkhoff map. Notice that it suffices to have one disk collide
with a wall in order to consider the application of the map, so
sometimes one of the two disks is just at the middle of
free flight. Each disk has two vectors originating at its centre,
which represents the tangent vectors $\delta q$ and 
$\delta p$ for each disk. 
The vectors are distinguished by colour. The colour of the vector pairs
also differentiates the disk 1 from disk 2. 

The purpose of our plot is to have an intuitive grasp of the
hyperbolic property of the tangent map. In this plot, which has mere 16
iterations of the map, the tangent vectors suffer a brutal growth after
some few collisions between the disks. Notice that collisions in
the wall only change orientation of the tangent vectors.
It is also visible the tendency of the vectors to align themselves
in a preferred direction, although small fluctuations are
expected for short times. An animated version of this plot 
shall be available on-line if this paper gets published. 

\begin{figure}
\centering
\includegraphics[width=0.9\textwidth]{TestQandPUnoVarios-MapeoTangente2Discos.pdf} 
\caption{The dynamics in the configuration and tangent space. The pink-blue pair
indicates Disk 1, the yellow-black Disk 2.}\label{TangentMap}
\end{figure}



\bibliography{../../notasmixtas/TwoDiskBiblio}



\end{document}
